# DH-SRD Automation Scripts

This directory contains automation scripts for syncing the Daggerheart SRD from GitHub to the vault's `04-RESOURCES/dh-srd/` directory.

## Scripts

### `enumerate_github_repo.py`
Enumerates all files in the seansbox/daggerheart-srd repository and creates a prioritized todo list.

**Usage:**
```bash
cd 99-CONFIG/dh-srd
python enumerate_github_repo.py
```

**Output:**
- `github_repo_files.json` - Complete file listing from the repository
- `dh-srd-pull-todo.md` - Markdown todo list for automation

### `dh_sync.py`
Main automation script that downloads files from GitHub and transforms them into properly formatted markdown files with YAML front-matter and attribution.

**Usage:**
```bash
cd 99-CONFIG/dh-srd
python dh_sync.py [options]
```

**Options:**
- `--todo PATH` - Path to todo markdown file
- `--status STATUS [STATUS ...]` - Filter by status (default: missing)
- `--max-files N` - Limit number of files to process
- `--vault-root PATH` - Root directory of vault (default: current)

**Examples:**
```bash
# Sync all missing files
python dh_sync.py

# Sync only first 5 missing files
python dh_sync.py --max-files 5

# Sync all files regardless of status
python dh_sync.py --status missing done  

# Use custom todo file
python dh_sync.py --todo custom_todo.md
```

## Workflow

1. **Generate Todo List:**
   ```bash
   python enumerate_github_repo.py
   ```

2. **Sync Files:**
   ```bash
   python dh_sync.py --max-files 10  # Start with a small batch
   ```

3. **Check Results:**
   - Review log files in this directory
   - Check `04-RESOURCES/dh-srd/` for new files
   - Verify YAML front-matter and attribution blocks

## File Structure

### Input
- `dh-srd-pull-todo.md` - Generated by enumerate_github_repo.py
- Markdown table columns: Priority, Status, Source Path, Output Path, File Type, Size

### Output
- Files saved to `04-RESOURCES/dh-srd/` with pattern `dh-{slug}.md`
- YAML front-matter includes: title, tags, source_url, license, created
- Attribution block at bottom with source info and download timestamp

### Logs
- `dh_sync_YYYYMMDD_HHMMSS.log` - Detailed sync log
- `successful_files_YYYYMMDD_HHMMSS.txt` - List of successfully synced files

## Tags System

The script automatically assigns tags based on source path:
- `daggerheart`, `srd` - Always included
- `class` - For files in classes/
- `ancestry` - For files in ancestries/
- `ability` - For files in abilities/
- `weapon` - For files in weapons/
- `armor` - For files in armor/
- `domain` - For files in domains/
- `subclass` - For files in subclasses/
- `adversary` - For files in adversaries/
- `environment` - For files in environments/
- `core-rules` - For files in contents/

## Subdirectory Structure

The script mirrors the repository structure in subfolders:
- Core rules → `04-RESOURCES/dh-srd/`
- Classes → `04-RESOURCES/dh-srd/`  
- Abilities → `04-RESOURCES/dh-srd/`
- etc.

All files use the `dh-{slug}.md` naming convention regardless of subdirectory.
